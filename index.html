<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upgrade Me App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --tg-bg: var(--tg-theme-bg-color, #ffffff);
            --tg-text: var(--tg-theme-text-color, #000000);
            --tg-link: var(--tg-theme-link-color, #2481cc);
            --tg-sec-bg: var(--tg-theme-secondary-bg-color, #f4f4f5);
            --gold: #ffcf40;
        }

        body { font-family: sans-serif; background: var(--tg-bg); color: var(--tg-text); margin: 0; padding-bottom: 70px; overflow-x: hidden; }
        
        /* –•–µ–¥–µ—Ä —Å –º–æ–Ω–µ—Ç–∞–º–∏ */
        .header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; background: var(--tg-sec-bg); sticky: top; top: 0; z-index: 10;
        }
        .coin-balance { font-weight: bold; color: var(--gold); font-size: 20px; display: flex; align-items: center; gap: 5px; }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .page { display: none; padding: 15px; animation: slideUp 0.3s ease; }
        .active { display: block; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –ú–µ–¥–∏—Ç–∞—Ü–∏–π */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
        .card {
            background: var(--tg-sec-bg); border-radius: 15px; padding: 20px;
            text-align: center; cursor: pointer; border: 2px solid transparent; transition: 0.2s;
        }
        .card:active { transform: scale(0.95); border-color: var(--tg-link); }
        .card img { width: 50px; height: 50px; margin-bottom: 10px; }

        /* –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –ø–ª–µ–µ—Ä/—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ */
        #overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--tg-bg); z-index: 100; flex-direction: column; align-items: center; justify-content: center;
        }

        /* –¢–∞–±-–±–∞—Ä */
        .tab-bar {
            position: fixed; bottom: 0; width: 100%; display: flex;
            background: var(--tg-sec-bg); border-top: 1px solid rgba(0,0,0,0.1); height: 65px;
        }
        .tab-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 10px; opacity: 0.5; }
        .active-tab { opacity: 1; color: var(--tg-link); }

        /* –ë–ñ–£ –§–æ—Ä–º–∞ */
        .bju-input { width: 80%; padding: 10px; margin: 5px; border-radius: 8px; border: 1px solid var(--tg-link); }
    </style>
</head>
<body>

    <div class="header">
        <span>Upgrade Me</span>
        <div class="coin-balance">ü™ô <span id="coinCount">0</span></div>
    </div>

    <div id="meditation" class="page active">
        <h3>–ú–µ–¥–∏—Ç–∞—Ü–∏–∏ üßò</h3>
        <div class="grid">
            <div class="card" onclick="startMeditation('–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ', 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3')">
                <div>üåä</div><div>–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ</div>
            </div>
            <div class="card" onclick="startMeditation('–°–æ–Ω', 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3')">
                <div>üåô</div><div>–°–æ–Ω</div>
            </div>
        </div>
    </div>

    <div id="bju" class="page">
        <h3>–¢—Ä–µ–∫–µ—Ä –ë–ñ–£ ü•ó</h3>
        <div id="bjuStats">–û—Å—Ç–∞–ª–æ—Å—å: 2000 –∫–∫–∞–ª</div>
        <input type="number" id="caloriesIn" class="bju-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–∞–ª–æ—Ä–∏–∏">
        <button onclick="addFood()" style="padding: 10px 20px;">–î–æ–±–∞–≤–∏—Ç—å –µ–¥—É</button>
    </div>

    <div id="workout" class="page">
        <h3>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ üí™</h3>
        <div class="card" style="width: 90%;" onclick="showExercises('–¢—Ä–∏—Ü–µ–ø—Å')">–¢—Ä–∏—Ü–µ–ø—Å</div>
        <div class="card" style="width: 90%;" onclick="showExercises('–°–ø–∏–Ω–∞')">–°–ø–∏–Ω–∞</div>
    </div>

    <div id="shop" class="page">
        <h3>–ú–∞–≥–∞–∑–∏–Ω üõí</h3>
        <div class="card">–ù–æ–≤–∞—è —Ç–µ–º–∞ –∑–∞ 100 ü™ô</div>
    </div>

    <div id="overlay">
        <h2 id="overlayTitle">–î–µ–π—Å—Ç–≤–∏–µ</h2>
        <div id="overlayContent" style="font-size: 50px; margin: 30px;">‚è≥</div>
        <button class="bju-input" onclick="closeOverlay()">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
    </div>

    <nav class="tab-bar">
        <div class="tab-item active-tab" onclick="openPage('meditation', this)"><span>üßò</span><span>–ú–µ–¥–∏—Ç–∞—Ü–∏—è</span></div>
        <div class="tab-item" onclick="openPage('bju', this)"><span>ü•ó</span><span>–ë–ñ–£</span></div>
        <div class="tab-item" onclick="openPage('workout', this)"><span>üí™</span><span>–ó–∞–ª</span></div>
        <div class="tab-item" onclick="openPage('shop', this)"><span>üõí</span><span>–ú–∞–≥–∞–∑–∏–Ω</span></div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let coins = parseInt(localStorage.getItem('coins')) || 0;
        document.getElementById('coinCount').innerText = coins;

        function addCoins(amount) {
            coins += amount;
            document.getElementById('coinCount').innerText = coins;
            localStorage.setItem('coins', coins);
            tg.HapticFeedback.notificationOccurred('success');
        }

        function openPage(pageId, el) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active-tab'));
            document.getElementById(pageId).classList.add('active');
            el.classList.add('active-tab');
        }

        // –ú–ï–î–ò–¢–ê–¶–ò–Ø
        function startMeditation(name, soundUrl) {
            const overlay = document.getElementById('overlay');
            const title = document.getElementById('overlayTitle');
            const content = document.getElementById('overlayContent');
            
            overlay.style.display = 'flex';
            title.innerText = name;
            
            let timeLeft = 5;
            content.innerText = timeLeft;

            const audio = new Audio(soundUrl);
            audio.play().catch(() => console.log("Audio play failed - need user interaction"));

            const timer = setInterval(() => {
                timeLeft--;
                content.innerText = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    audio.pause();
                    content.innerText = "‚ú® +10 –∫–æ–∏–Ω–æ–≤!";
                    addCoins(10);
                }
            }, 1000);
        }

        function closeOverlay() {
            document.getElementById('overlay').style.display = 'none';
        }

        // –ë–ñ–£ –õ–û–ì–ò–ö–ê
        let dailyLimit = 2000;
        function addFood() {
            const val = document.getElementById('caloriesIn').value;
            if(val) {
                dailyLimit -= val;
                document.getElementById('bjuStats').innerText = `–û—Å—Ç–∞–ª–æ—Å—å: ${dailyLimit} –∫–∫–∞–ª`;
                document.getElementById('caloriesIn').value = '';
            }
        }
    </script>
</body>
</html>
